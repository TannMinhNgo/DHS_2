{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card app-card">
                <div class="card-header app-card-header">
                    <h4 class="mb-0">
                        {% if laptop %}
                            S·ª≠a laptop: {{ laptop.name }}
                        {% else %}
                            Th√™m laptop m·ªõi
                        {% endif %}
                    </h4>
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <div class="row">
                            <!-- Th√¥ng tin c∆° b·∫£n -->
                            <div class="col-md-6">
                                <h5 class="mb-3">Th√¥ng tin c∆° b·∫£n</h5>
                                
                                <div class="mb-3">
                                    <label for="name" class="form-label">T√™n laptop *</label>
                                    <input type="text" class="form-control" id="name" name="name" 
                                           value="{{ laptop.name if laptop else '' }}" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="brand" class="form-label">Th∆∞∆°ng hi·ªáu *</label>
                                    <select class="form-select" id="brand" name="brand" required>
                                        <option value="">Ch·ªçn th∆∞∆°ng hi·ªáu</option>
                                        <option value="ASUS" {{ 'selected' if laptop and laptop.brand == 'ASUS' else '' }}>ASUS</option>
                                        <option value="HP" {{ 'selected' if laptop and laptop.brand == 'HP' else '' }}>HP</option>
                                        <option value="Lenovo" {{ 'selected' if laptop and laptop.brand == 'Lenovo' else '' }}>Lenovo</option>
                                        <option value="Dell" {{ 'selected' if laptop and laptop.brand == 'Dell' else '' }}>Dell</option>
                                        <option value="Acer" {{ 'selected' if laptop and laptop.brand == 'Acer' else '' }}>Acer</option>
                                        <option value="MSI" {{ 'selected' if laptop and laptop.brand == 'MSI' else '' }}>MSI</option>
                                        <option value="Apple" {{ 'selected' if laptop and laptop.brand == 'Apple' else '' }}>Apple</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="category" class="form-label">Danh m·ª•c *</label>
                                    <select class="form-select" id="category" name="category" required>
                                        <option value="">Ch·ªçn danh m·ª•c</option>
                                        <option value="office" {{ 'selected' if laptop and laptop.category == 'office' else '' }}>VƒÉn ph√≤ng</option>
                                        <option value="student" {{ 'selected' if laptop and laptop.category == 'student' else '' }}>Sinh vi√™n</option>
                                        <option value="gaming" {{ 'selected' if laptop and laptop.category == 'gaming' else '' }}>Gaming</option>
                                        <option value="design" {{ 'selected' if laptop and laptop.category == 'design' else '' }}>Thi·∫øt k·∫ø</option>
                                        <option value="dev" {{ 'selected' if laptop and laptop.category == 'dev' else '' }}>L·∫≠p tr√¨nh</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="price" class="form-label">Gi√° (VND) *</label>
                                    <input type="number" class="form-control" id="price" name="price" 
                                           value="{{ laptop.price if laptop else '' }}" required>
                                </div>
                            </div>
                            
                            <!-- Th√¥ng s·ªë k·ªπ thu·∫≠t -->
                            <div class="col-md-6">
                                <h5 class="mb-3">Th√¥ng s·ªë k·ªπ thu·∫≠t</h5>
                                
                                <div class="mb-3">
                                    <label for="cpu" class="form-label">CPU *</label>
                                    <input type="text" class="form-control" id="cpu" name="cpu" 
                                           value="{{ laptop.cpu if laptop else '' }}" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="ram_gb" class="form-label">RAM (GB) *</label>
                                    <select class="form-select" id="ram_gb" name="ram_gb" required>
                                        <option value="">Ch·ªçn RAM</option>
                                        <option value="4" {{ 'selected' if laptop and laptop.ram_gb == 4 else '' }}>4GB</option>
                                        <option value="8" {{ 'selected' if laptop and laptop.ram_gb == 8 else '' }}>8GB</option>
                                        <option value="16" {{ 'selected' if laptop and laptop.ram_gb == 16 else '' }}>16GB</option>
                                        <option value="32" {{ 'selected' if laptop and laptop.ram_gb == 32 else '' }}>32GB</option>
                                        <option value="64" {{ 'selected' if laptop and laptop.ram_gb == 64 else '' }}>64GB</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="gpu" class="form-label">GPU</label>
                                    <input type="text" class="form-control" id="gpu" name="gpu" 
                                           value="{{ laptop.gpu if laptop else '' }}">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="storage" class="form-label">L∆∞u tr·ªØ *</label>
                                    <input type="text" class="form-control" id="storage" name="storage" 
                                           value="{{ laptop.storage if laptop else '' }}" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="screen" class="form-label">M√†n h√¨nh *</label>
                                    <input type="text" class="form-control" id="screen" name="screen" 
                                           value="{{ laptop.screen if laptop else '' }}" required>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Th√¥ng tin pin -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h5 class="mb-3">Th√¥ng tin pin</h5>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="battery_capacity" class="form-label">Dung l∆∞·ª£ng pin (Wh)</label>
                                    <input type="number" class="form-control" id="battery_capacity" name="battery_capacity" 
                                           value="{{ laptop.battery_capacity if laptop else '' }}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="battery_life_office" class="form-label">Th·ªùi gian vƒÉn ph√≤ng (ph√∫t)</label>
                                    <input type="number" class="form-control" id="battery_life_office" name="battery_life_office" 
                                           value="{{ laptop.battery_life_office if laptop else '' }}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="battery_life_gaming" class="form-label">Th·ªùi gian gaming (ph√∫t)</label>
                                    <input type="number" class="form-control" id="battery_life_gaming" name="battery_life_gaming" 
                                           value="{{ laptop.battery_life_gaming if laptop else '' }}">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ƒêi·ªÉm s·ªë benchmark -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h5 class="mb-3">ƒêi·ªÉm s·ªë benchmark</h5>
                            </div>
                            <div class="col-md-6">
                                <h6>CPU (Geekbench 6)</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="cpu_single_core_plugged" class="form-label">Single Core (C·∫Øm s·∫°c)</label>
                                            <input type="number" class="form-control" id="cpu_single_core_plugged" name="cpu_single_core_plugged" 
                                                   value="{{ laptop.cpu_single_core_plugged if laptop else '' }}">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="cpu_single_core_battery" class="form-label">Single Core (D√πng pin)</label>
                                            <input type="number" class="form-control" id="cpu_single_core_battery" name="cpu_single_core_battery" 
                                                   value="{{ laptop.cpu_single_core_battery if laptop else '' }}">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="cpu_multi_core_plugged" class="form-label">Multi Core (C·∫Øm s·∫°c)</label>
                                            <input type="number" class="form-control" id="cpu_multi_core_plugged" name="cpu_multi_core_plugged" 
                                                   value="{{ laptop.cpu_multi_core_plugged if laptop else '' }}">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="cpu_multi_core_battery" class="form-label">Multi Core (D√πng pin)</label>
                                            <input type="number" class="form-control" id="cpu_multi_core_battery" name="cpu_multi_core_battery" 
                                                   value="{{ laptop.cpu_multi_core_battery if laptop else '' }}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>GPU</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="gpu_score_plugged" class="form-label">ƒêi·ªÉm GPU (C·∫Øm s·∫°c)</label>
                                            <input type="number" class="form-control" id="gpu_score_plugged" name="gpu_score_plugged" 
                                                   value="{{ laptop.gpu_score_plugged if laptop else '' }}">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="gpu_score_battery" class="form-label">ƒêi·ªÉm GPU (D√πng pin)</label>
                                            <input type="number" class="form-control" id="gpu_score_battery" name="gpu_score_battery" 
                                                   value="{{ laptop.gpu_score_battery if laptop else '' }}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Upload h√¨nh ·∫£nh -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h5 class="mb-3">üñºÔ∏è H√¨nh ·∫£nh</h5>
                                <div class="mb-3">
                                    <label for="image" class="form-label">Upload h√¨nh ·∫£nh</label>
                                    <input type="file" class="form-control" id="image" name="image" accept="image/*">
                                    <div class="form-text">H·ªó tr·ª£: JPG, PNG, WebP. K√≠ch th∆∞·ªõc t·ªëi ƒëa: 5MB</div>
                                </div>
                                
                                {% if laptop and laptop.image_url %}
                                <div class="mb-3">
                                    <label class="form-label">H√¨nh ·∫£nh hi·ªán t·∫°i:</label>
                                    <div>
                                        <img src="{{ laptop.image_url }}" alt="{{ laptop.name }}" 
                                             class="img-thumbnail" style="max-width: 200px; max-height: 150px;">
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- N√∫t thao t√°c -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="d-flex justify-content-between">
                                    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-secondary">Quay l·∫°i</a>
                                    <div>
                                        <button type="reset" class="btn btn-outline-secondary me-2">L√†m m·ªõi</button>
                                        <button type="submit" class="btn btn-primary">
                                            {% if laptop %}C·∫≠p nh·∫≠t{% else %}Th√™m m·ªõi{% endif %}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Preview h√¨nh ·∫£nh
document.getElementById('image').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        if (file.size > 5 * 1024 * 1024) {
            alert('File qu√° l·ªõn! K√≠ch th∆∞·ªõc t·ªëi ƒëa l√† 5MB.');
            this.value = '';
            return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
            // C√≥ th·ªÉ th√™m preview ·ªü ƒë√¢y n·∫øu c·∫ßn
        };
        reader.readAsDataURL(file);
    }
});

// Validation
document.querySelector('form').addEventListener('submit', function(e) {
    const price = document.getElementById('price').value;
    if (price && price < 0) {
        e.preventDefault();
        alert('Gi√° kh√¥ng ƒë∆∞·ª£c √¢m!');
        return false;
    }
});
</script>
{% endblock %} 